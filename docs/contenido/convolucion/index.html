<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Convolución # <img hidden id=&#34;uploaded-image&#34; src=&#34;&#34;></img> <!--imagen subida, de ella se obtiene la representación binaria que luego es usada por el canvas para obtener la representación en RGBA --> <canvas hidden id=&#34;canvas-for-rgba&#34;></canvas> <!-- canvas solo para dibujar la imagen subida y obtener la representación en RGBA, por eso puede ser oculta --> <input type=&#34;file&#34; id=&#34;image-input&#34; accept=&#34;image/jpeg, image/png, image/jpg&#34;> <select id=&#34;kernel-select&#34;> <option selected value=&#34;identity&#34;>Identity</option> <option value=&#34;gaussian-blur&#34;>Gaussian Blur</option> <option value=&#34;sharpen&#34;>Sharpen</option> <option value=&#34;outline&#34;>Outline</option> <option value=&#34;emboss&#34;>Emboss</option> <option value=&#34;left-sobel&#34;>Left Sobel</option> <option value=&#34;right-sobel&#34;>Right Sobel</option> <option value=&#34;top-sobel&#34;>Top Sobel</option> <option value=&#34;bottom-sobel&#34;>Bottom Sobel</option> </select> <canvas id=&#34;transformed-image-canvas&#34;></canvas> <script> // función de procesamiento de la imagen function processImage(image, width, height) { let canvas = document."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content><meta property="og:description" content="Convolución # <img hidden id=&#34;uploaded-image&#34; src=&#34;&#34;></img> <!--imagen subida, de ella se obtiene la representación binaria que luego es usada por el canvas para obtener la representación en RGBA --> <canvas hidden id=&#34;canvas-for-rgba&#34;></canvas> <!-- canvas solo para dibujar la imagen subida y obtener la representación en RGBA, por eso puede ser oculta --> <input type=&#34;file&#34; id=&#34;image-input&#34; accept=&#34;image/jpeg, image/png, image/jpg&#34;> <select id=&#34;kernel-select&#34;> <option selected value=&#34;identity&#34;>Identity</option> <option value=&#34;gaussian-blur&#34;>Gaussian Blur</option> <option value=&#34;sharpen&#34;>Sharpen</option> <option value=&#34;outline&#34;>Outline</option> <option value=&#34;emboss&#34;>Emboss</option> <option value=&#34;left-sobel&#34;>Left Sobel</option> <option value=&#34;right-sobel&#34;>Right Sobel</option> <option value=&#34;top-sobel&#34;>Top Sobel</option> <option value=&#34;bottom-sobel&#34;>Bottom Sobel</option> </select> <canvas id=&#34;transformed-image-canvas&#34;></canvas> <script> // función de procesamiento de la imagen function processImage(image, width, height) { let canvas = document."><meta property="og:type" content="article"><meta property="og:url" content="https://anfbalceroce.github.io/VisualComputing/docs/contenido/convolucion/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2022-09-04T16:22:21-05:00"><title>Convolucion | Visual Computing 2022-2</title><link rel=manifest href=/VisualComputing/manifest.json><link rel=icon href=/VisualComputing/favicon.png type=image/x-icon><link rel=stylesheet href=/VisualComputing/book.min.ab46de3e725a6415339a37bba23a0067534a37289b063c9f8d011515a63097a8.css integrity="sha256-q0bePnJaZBUzmje7ojoAZ1NKNyibBjyfjQEVFaYwl6g=" crossorigin=anonymous><script defer src=/VisualComputing/flexsearch.min.js></script>
<script defer src=/VisualComputing/en.search.min.ccfec1f84b9959d4ec45bdb1ebed542a0920c60a99336ba0a6f85fdacc5cfd85.js integrity="sha256-zP7B+EuZWdTsRb2x6+1UKgkgxgqZM2ugpvhf2sxc/YU=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/VisualComputing/><span>Visual Computing 2022-2</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li class=book-section-flat><span>Contenido</span><ul><li><a href=/VisualComputing/docs/contenido/convolucion/ class=active>Convolucion</a></li><li><a href=/VisualComputing/docs/contenido/ilusiones/>Ilusiones</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/VisualComputing/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Convolucion</strong>
<label for=toc-control><img src=/VisualComputing/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#convolución>Convolución</a></li></ul></nav></aside></header><article class=markdown><h1 id=convolución>Convolución
<a class=anchor href=#convoluci%c3%b3n>#</a></h1><iframe src=/VisualComputing/kernels.html style=border:none;width:100%;height:1000px></iframe><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>img</span> <span style=color:#a6e22e>hidden</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;uploaded-image&#34;</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span>&gt;&lt;/<span style=color:#f92672>img</span>&gt; <span style=color:#75715e>&lt;!--imagen subida, de ella se obtiene la representación binaria que luego es usada por el canvas para obtener la representación en RGBA --&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>canvas</span> <span style=color:#a6e22e>hidden</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;canvas-for-rgba&#34;</span>&gt;&lt;/<span style=color:#f92672>canvas</span>&gt; <span style=color:#75715e>&lt;!-- canvas solo para dibujar la imagen subida y obtener la representación en RGBA, por eso puede ser oculta --&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;file&#34;</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;image-input&#34;</span> <span style=color:#a6e22e>accept</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;image/jpeg, image/png, image/jpg&#34;</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>select</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;kernel-select&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>option</span> <span style=color:#a6e22e>selected</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;identity&#34;</span>&gt;Identity&lt;/<span style=color:#f92672>option</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;gaussian-blur&#34;</span>&gt;Gaussian Blur&lt;/<span style=color:#f92672>option</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;sharpen&#34;</span>&gt;Sharpen&lt;/<span style=color:#f92672>option</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;outline&#34;</span>&gt;Outline&lt;/<span style=color:#f92672>option</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;emboss&#34;</span>&gt;Emboss&lt;/<span style=color:#f92672>option</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;left-sobel&#34;</span>&gt;Left Sobel&lt;/<span style=color:#f92672>option</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;right-sobel&#34;</span>&gt;Right Sobel&lt;/<span style=color:#f92672>option</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;top-sobel&#34;</span>&gt;Top Sobel&lt;/<span style=color:#f92672>option</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;bottom-sobel&#34;</span>&gt;Bottom Sobel&lt;/<span style=color:#f92672>option</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>select</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>canvas</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;transformed-image-canvas&#34;</span>&gt;&lt;/<span style=color:#f92672>canvas</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// función de procesamiento de la imagen
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>processImage</span>(<span style=color:#a6e22e>image</span>, <span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>height</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>canvas</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#34;#canvas-for-rgba&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>canvas</span>.<span style=color:#a6e22e>width</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>width</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>canvas</span>.<span style=color:#a6e22e>height</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>height</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>ctx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>canvas</span>.<span style=color:#a6e22e>getContext</span>(<span style=color:#e6db74>&#34;2d&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>drawImage</span>(<span style=color:#a6e22e>image</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>data</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>getImageData</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>height</span>).<span style=color:#a6e22e>data</span>; <span style=color:#75715e>// data es un arreglo con los valores RGBA de la imagen (arreglo unidimensional)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>transformed_data</span> <span style=color:#f92672>=</span> [] <span style=color:#75715e>// es el arreglo transformado o procesado
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>ker</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>kernel</span>(document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#39;#kernel-select&#39;</span>).<span style=color:#a6e22e>value</span>) <span style=color:#75715e>// kernel a usar
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>4</span>) { <span style=color:#75715e>// se itera de 4, i corresponde al valor R del pixel i-ésimo de la imagen
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>r</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>data</span>[<span style=color:#a6e22e>i</span>];
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>g</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>data</span>[<span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>b</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>data</span>[<span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>];
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>a</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>data</span>[<span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>3</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>pos</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>position</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>height</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>nbs</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>neighbours</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>pos</span>, <span style=color:#a6e22e>width</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>ws</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>weights</span>(<span style=color:#a6e22e>ker</span>, <span style=color:#a6e22e>pos</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>sum</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ws</span>.<span style=color:#a6e22e>reduce</span>((<span style=color:#a6e22e>partialSum</span>, <span style=color:#a6e22e>a</span>) =&gt; <span style=color:#a6e22e>partialSum</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>a</span>, <span style=color:#ae81ff>0</span>); <span style=color:#75715e>// en la matriz se debe garantizar que la suma de los pesos no sea cero para que funcione
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>rtotal</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>gtotal</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>btotal</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>atotal</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>// suma ponderada para cada valor R G B A 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>nbs</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>j</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>rtotal</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>data</span>[<span style=color:#a6e22e>nbs</span>[<span style=color:#a6e22e>j</span>]] <span style=color:#f92672>*</span> <span style=color:#a6e22e>ws</span>[<span style=color:#a6e22e>j</span>]
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>gtotal</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>data</span>[<span style=color:#a6e22e>nbs</span>[<span style=color:#a6e22e>j</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>*</span> <span style=color:#a6e22e>ws</span>[<span style=color:#a6e22e>j</span>]
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>btotal</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>data</span>[<span style=color:#a6e22e>nbs</span>[<span style=color:#a6e22e>j</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>] <span style=color:#f92672>*</span> <span style=color:#a6e22e>ws</span>[<span style=color:#a6e22e>j</span>]
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>atotal</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>data</span>[<span style=color:#a6e22e>nbs</span>[<span style=color:#a6e22e>j</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>3</span>] <span style=color:#f92672>*</span> <span style=color:#a6e22e>ws</span>[<span style=color:#a6e22e>j</span>]
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>// se obtiene la suma ponderada: error cuando sum es cero ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>R</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>round</span>(<span style=color:#a6e22e>rtotal</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>sum</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>G</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>round</span>(<span style=color:#a6e22e>gtotal</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>sum</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>B</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>round</span>(<span style=color:#a6e22e>btotal</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>sum</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>A</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>round</span>(<span style=color:#a6e22e>atotal</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>sum</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>// se agregan los nuevos valores al arreglo transformado
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>transformed_data</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>R</span>)
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>transformed_data</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>G</span>)
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>transformed_data</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>B</span>)
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>transformed_data</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>A</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// se crea canvas de la imagen transformada para mostrarla en pantalla
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// nota: se necesita usar canvas para poder visualizar la imagen apartir del arreglo de R G B A
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>canvas</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#34;#transformed-image-canvas&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>canvas</span>.<span style=color:#a6e22e>width</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>width</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>canvas</span>.<span style=color:#a6e22e>height</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>height</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ctx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>canvas</span>.<span style=color:#a6e22e>getContext</span>(<span style=color:#e6db74>&#34;2d&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>imageData</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>canvas</span>.<span style=color:#a6e22e>getContext</span>(<span style=color:#e6db74>&#39;2d&#39;</span>).<span style=color:#a6e22e>createImageData</span>(<span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>height</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>imageData</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>set</span>(<span style=color:#a6e22e>transformed_data</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>putImageData</span>(<span style=color:#a6e22e>imageData</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// se procesa imagen cuando se sube archivo
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>image_input</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#34;#image-input&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>image_input</span>.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#34;change&#34;</span>, <span style=color:#66d9ef>function</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>reader</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>FileReader</span>();
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>reader</span>.<span style=color:#a6e22e>readAsDataURL</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>files</span>[<span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>reader</span>.<span style=color:#a6e22e>onload</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>e</span>) =&gt; {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>image</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Image</span>();
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>image</span>.<span style=color:#a6e22e>src</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>target</span>.<span style=color:#a6e22e>result</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>image</span>.<span style=color:#a6e22e>onload</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>e</span>) =&gt; {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>width</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>target</span>.<span style=color:#a6e22e>width</span>;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>height</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>target</span>.<span style=color:#a6e22e>height</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>uploaded_image</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>reader</span>.<span style=color:#a6e22e>result</span>
</span></span><span style=display:flex><span>                document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#34;#uploaded-image&#34;</span>).<span style=color:#a6e22e>src</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>uploaded_image</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>processImage</span>(<span style=color:#a6e22e>image</span>, <span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>height</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            };
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// se procesa imagen cuando se cambia el valor del select kernel
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>kernel_select</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#34;#kernel-select&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>kernel_select</span>.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#34;change&#34;</span>, <span style=color:#66d9ef>function</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>image</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Image</span>();
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#34;#uploaded-image&#34;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>image</span>.<span style=color:#a6e22e>src</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>src</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>width</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>height</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>image</span>.<span style=color:#a6e22e>src</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>processImage</span>(<span style=color:#a6e22e>image</span>, <span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>height</span>)
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// obtener posición del pixel según su índice y los valores weight y height
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>position</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>h</span>) =&gt; { 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;top-left-corner&#39;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>==</span> (<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;top-right-corner&#39;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>h</span> <span style=color:#f92672>*</span> ((<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;bottom-left-corner&#39;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>==</span> (<span style=color:#a6e22e>h</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;bottom-right-corner&#39;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> (<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;top-row&#39;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>%</span> (<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>==</span> (<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;right-row&#39;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>h</span> <span style=color:#f92672>*</span> ((<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> (<span style=color:#a6e22e>h</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;bottom-row&#39;</span>;      
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>%</span> (<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;left-row&#39;</span>;        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;inner-cell&#39;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// arreglo de índices según posición, que será usado para obtener las posiciones de los pixeles vecinos (neighbours) y 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// las posiciones de los pesos de la matriz del kernel
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>indexes</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>position</span>) =&gt; { 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>position</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;inner-cell&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>8</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>position</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;left-row&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [   <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, 
</span></span><span style=display:flex><span>                       <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>,
</span></span><span style=display:flex><span>                       <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>8</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>position</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;right-row&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>7</span>   ]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>position</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;top-row&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [ 
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>8</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>position</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;bottom-row&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>,
</span></span><span style=display:flex><span>                           ]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>position</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;top-right-corner&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [                               
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>7</span>   ]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>position</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;top-left-corner&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [
</span></span><span style=display:flex><span>                       <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>,
</span></span><span style=display:flex><span>                       <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>8</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>position</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;bottom-left-corner&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [   <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, 
</span></span><span style=display:flex><span>                       <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>                           ]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>position</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;bottom-right-corner&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>   
</span></span><span style=display:flex><span>                           ]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> []
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// arreglo con los índices de los pixeles vecinos
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>neighbours</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>position</span>, <span style=color:#a6e22e>w</span>) =&gt; {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>matrix</span> <span style=color:#f92672>=</span> [<span style=color:#a6e22e>i</span> <span style=color:#f92672>-</span> (<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>4</span>, <span style=color:#a6e22e>i</span> <span style=color:#f92672>-</span> (<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>), <span style=color:#a6e22e>i</span> <span style=color:#f92672>-</span> (<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>+</span> <span style=color:#ae81ff>4</span>, 
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>i</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>4</span>,           <span style=color:#a6e22e>i</span>          , <span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>4</span>,
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> (<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>4</span>, <span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> (<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>), <span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> (<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>+</span> <span style=color:#ae81ff>4</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>idx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>indexes</span>(<span style=color:#a6e22e>position</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>nbs</span> <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>idx</span>.<span style=color:#a6e22e>forEach</span>((<span style=color:#a6e22e>i</span>) =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>nbs</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>matrix</span>[<span style=color:#a6e22e>i</span>])
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>nbs</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// kernels disponibles: cada matriz es una matriz de pesos
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>kernel</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>kernel</span>) =&gt; {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>kernel</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;identity&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>kernel</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;gaussian-blur&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>kernel</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;emboss&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [<span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>kernel</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;left-sobel&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>kernel</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;right-sobel&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#75715e>// se agregó 1 en la posición central para garantizar que suma de pesos no sea cero
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>kernel</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;top-sobel&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                    <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>kernel</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;bottom-sobel&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>kernel</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;sharpen&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [<span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>5</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>kernel</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;outline&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>9</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                    <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> []
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// arreglo de pesos que se usarán en la suma ponderada del pixel actual: depende del kernel y de la posición del pixel
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>weights</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>ker</span>, <span style=color:#a6e22e>position</span>) =&gt; {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>idx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>indexes</span>(<span style=color:#a6e22e>position</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>ws</span> <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>idx</span>.<span style=color:#a6e22e>forEach</span>((<span style=color:#a6e22e>i</span>) =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>ws</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>ker</span>[<span style=color:#a6e22e>i</span>])
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>ws</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>script</span>&gt;
</span></span></code></pre></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/anfbalceroce/VisualComputing/commit/8dfad43e646abeab3993420017c4889679b0e049 title='Last modified by este6an13 | September 4, 2022' target=_blank rel=noopener><img src=/VisualComputing/svg/calendar.svg class=book-icon alt=Calendar>
<span>September 4, 2022</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#convolución>Convolución</a></li></ul></nav></div></aside></main></body></html>